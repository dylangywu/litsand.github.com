---
layout: post
title: "CVE 2012 3268研究总结"
description: ""
category: 
tags: []
---
{% include JB/setup %}

## 参考资料 ##

[Kurt Grutzmacher最早发布的文章](http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html)

[cvedetail](http://www.cvedetails.com/cve/CVE-2012-3268/)

[安全预警-涉及华为多种产品的SNMP漏洞](http://www.huawei.com/cn/security/psirt/security-bulletins/security-advisories/hw-u_194647.htm)


## 漏洞相关的oid ##

Kurt Grutzmacher的文档中提到了25506和2011.10两种类型，[可以参考之前的文章](http://grutztopia.jingojango.net/2012/10/hph3c-and-huawei-snmp-weak-access-to.html)这两种oid应该仅仅是h3c的，华为还有还有另外一些oid可以获取帐号密码。HP的没有测试。

让我产生疑问的地方在[wooyun的这个漏洞](http://www.wooyun.org/bugs/wooyun-2010-021964)@s3cur1ty 这里用的这个oid显然不是Kurt Grutzmacher中提到的那两种。话说这个oid确实没看懂，CNVD的回复也提到向洞主请教所使用的指令。洞主自己在回复里提到说这是华为的0day，应该算是华为私有mib泄漏。而从华为的回复的安全预警中可以到，这也是cve-2012-3268的问题。本质上就是通过一个read权限的团体字读取帐号密码。而可以读取的oid不仅仅是Kurt Grutzmacher提到的两种，比如@s3cur1ty这里提到的就是另外一个。

## 相关测试 ##

测试型号：ME60 V600R002C02SPC700

获取帐号的oid为:

	1.3.6.1.4.1.2011.5.2.1.10.1.1.6.97.110.113.117.97.110 anquan 
	1.3.6.1.4.1.2011.5.2.1.10.1.2.6.97.110.113.117.97.110 K2+L5"^N:6&X]&8.21CN&Q!!

参考s3cur1t提交的漏洞，可见华为有些设备还可以通过walk

	1.3.6.1.4.1.2011.5.2.1.10.1
这个节点来获取帐号密码。

！[test]({site.imgurl}huawei1.png)

